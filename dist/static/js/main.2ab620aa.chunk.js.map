{"version":3,"sources":["core/helpers.js","configuration/settings.js","reducers/helpers/assetHelper.js","reducers/helpers/navHelper.js","reducers/navReducer.js","reducers/assetReducer.js","reducers/mainReducer.js","components/View.js","components/ScrollableLayer.js","components/Projector.js","core/Container.js","actions/navActions.js","helpers/objectTools.js","helpers/macrosTools.js","core/DataParser.js","helpers/stringTools.js","core/DataManager.js","actions/appActions.js","core/Control.js","actions/assetActions.js","App.js","reportWebVitals.js","index.js"],"names":["isLocal","test","document","location","toString","settings","window","content","store","developerTitle","developerUrl","developerHead","developerTexts","startAppText","assetsUrl","defaultState","playbackStarted","position","viewPosition","cacheStack","readyToInit","blockRender","blockInteraction","isMobile","MobileDetect","navigator","userAgent","mobile","isDev","indexOf","anyImage","indexHtmlFile","parentWindowId","useEmbeddedContent","checkSlideLoaded","layers","ready","layerName","layer","loaded","ignore","updateCacheStack","index","state","cacheIndex","splice","push","length","cacheSize","map","v","slide","sequence","Object","values","included","visible","resetIncludedLayers","target","id","isIncluded","reduceViewLoaded","slideIndex","layerId","reduceReady","i","static","startPosition","reduceToSlideIndex","reduceToSlideId","find","navReducer","action","console","log","type","name","hiddenNow","assetReducer","mainReducerController","data","mainReducer","extraAction","View","this","props","source","path","containerLeft","containerTop","containerRight","containerBottom","join","left","bounds","native","maxWidth","size","width","top","maxHeight","height","align","Math","round","scale","containerWidth","containerHeight","margin","l","r","t","b","className","style","visibility","hidden","invisible","transform","title","src","right","bottom","Component","ScrollableLayer","transition","from","to","fromOffset","toOffset","scrollOffset","prevProps","prevState","snapshot","setState","master","onTransitionReady","isntStatic","scrollPosition","fromPosition","toPosition","duration","easing","delay","onTransitionEnd","transitionReady","xPosition","hide","Layer","currentSlide","Container","transitionReadyHandler","bind","unsubscribe","subscribe","onStoreChange","mounted","getState","dispatch","windowWidth","windowHeight","conf","boxScale","min","minWidth","minHeight","boxWidth","boxHeight","boxLeft","offsetX","boxTop","offsetY","boxFontSize","nominalFontSize","fontSize","getElementsByTagName","children","getViewPort","updateGlobalFontSize","background","globalBg","containerBg","Projector","concatObjects","object1","object2","result","keys","undefined","applyMacrosObject","object","regExp","RegExp","replace","DataParser","sheet","reduce","a","A","B","parseLayer","split","frame","clip","parseSource","level","disable","marginParse","regexp","matchCount","matchArray","exec","matches","getMatches","ma","mv","mi","Number","sort","layerIndex","masterLayer","template","params","dirtyJson","parse","error","menus","menu","property","origin","addition","oLayer","aLayer","nLayer","slides","j","templates","concatLayers","setupLayers","parseLayers","parseTemplates","parseSequence","parseSettings","parseMenus","collectSequence","extraData","parseExtraData","DataManager","isLoading","isLoaded","loader","dataParser","load","callback","setTimeout","callLater","wb","XLSX","read","e","onContentLoadError","convertSheetsToTables","Sheets","onContentLoad","loadXlsx","contentUrl","lastError","href","dataLoaded","loadDataError","setStoreData","loadStoreDataError","url","oReq","XMLHttpRequest","open","responseType","onload","response","arr","fixXlsx","btoaValue","btoa","outContentToConsole","send","o","w","byteLength","String","fromCharCode","apply","Uint8Array","slice","rows","cells","cellId","y","substr","x","Control","initInteractions","sendInit","sendMessage","addEventListener","event","eventType","eventSource","slideLayer","processInteraction","targetWindow","targetName","frames","postMessage","slideId","showLayer","switchLayer","Store","createStore","__REDUX_DEVTOOLS_EXTENSION__","App","initHandler","resizeHandler","windowInnerWidth","documentElement","clientWidth","body","innerWidth","windowInnerHeight","clientHeight","innerHeight","updateLayout","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2ab620aa.chunk.js","sourcesContent":["import MobileDetect from 'mobile-detect'\r\nimport settings from '../configuration/settings.js';\r\n\r\nexport const callLater = (callback,delay = 100) => {\r\n  return setTimeout(callback,delay);\r\n}\r\n\r\nexport const isMobile = () => {\r\n  var mobileDetect = new MobileDetect(window.navigator.userAgent);\r\n  return mobileDetect.mobile();\r\n}\r\n\r\nexport const isLocal = () => {\r\n  return !(/^h/.test(document.location.toString()));\r\n}\r\n\r\nexport const objectIsEmpty = (object) => {\r\n  return Object.keys(object).length === 0 && object.constructor === Object;\r\n}\r\n\r\nexport const addUniqueToUrl = (url) => {\r\n  if (url) {\r\n    let uStr=new Date().getTime();\r\n    if (url.indexOf(\"?\")<0) {\r\n      url = url+\"?u=\"+uStr;\r\n    } else {\r\n      url = url+\"&u=\"+uStr;\r\n    }\r\n  }\r\n  return url;\r\n}\r\n\r\n\r\nexport const openLink = (link) => {\r\n  window.open(link,\"_blank\")\r\n}\r\n\r\nexport const downloadLink = (link) => {\r\n\r\n  link=addUniqueToUrl(link);\r\n\r\n  let a = document.createElement('a');\r\n  a.href = link;\r\n\r\n  link = link.substr(link.lastIndexOf('/') + 1);\r\n  if (link.indexOf('?')>=0) {\r\n    link = link.substr(0,link.indexOf('?'));\r\n  }\r\n\r\n  if ((settings.isLocal)&&(link.match(settings.anyImage))) {\r\n    a.target=\"_blank\";\r\n  } else {\r\n    a.download = link;\r\n  }\r\n  a.click();\r\n\r\n}\r\n\r\n\r\nexport const makeRequestUrl = (requestId,campName) => {\r\n\r\n  campName=campName.replace(/~/g,\"[~]\");\r\n  campName=campName.replace(/ /g,\"~\");\r\n  return \"/\"+requestId+\"/\"+campName+\"/\";\r\n}\r\n","import { isMobile,isLocal } from '../core/helpers';\r\n\r\nlet assetsUrl = \".\"\r\n\r\nconst settings = {\r\n  ...window.settings,\r\n  content:window.content,\r\n\r\n  store:{ },\r\n  developerTitle:\"mediasmit.ru\",\r\n  developerUrl:\"http://www.mediasmit.ru/\",\r\n  developerHead:null,\r\n  developerTexts:[\r\n    \"Мы создаем digital-продукты, направленные на решение бизнес-задач клиентов\",\r\n    \"mediasmit.ru\",\r\n  ],\r\n\r\n  startAppText:\"Presentation Engine started\",\r\n\r\n  assetsUrl: assetsUrl,\r\n\r\n  defaultState:{\r\n    playbackStarted:false,\r\n    position:-1,\r\n    viewPosition:0,\r\n    cacheStack:[],\r\n    readyToInit:false,\r\n    blockRender:false,\r\n    blockInteraction:false,\r\n  },\r\n\r\n  isMobile:isMobile(),\r\n  isLocal:isLocal(),\r\n  isDev:(document.location.toString().indexOf(\"localhost\")>0),\r\n\r\n  anyImage:/\\.(gif|jpg|jpeg|png|svg)$/gi,\r\n  indexHtmlFile:\"index.html\",\r\n\r\n  parentWindowId:\"PARENT\",\r\n}\r\n\r\nsettings.useEmbeddedContent=settings.useEmbeddedContent||isLocal();\r\n\r\nexport default settings;\r\n","import settings from '../../configuration/settings.js'\r\n\r\nconst checkSlideLoaded = (layers) => {\r\n  let ready = true;\r\n  for (let layerName in layers) {\r\n    let layer = layers[layerName];\r\n    if ((!layer.loaded)&&(!layer.ignore)) {\r\n      ready = false;\r\n      break;\r\n    }\r\n  }\r\n  return ready;\r\n}\r\n\r\nconst updateCacheStack = (index,state) => {\r\n  let cacheStack=state.cacheStack;\r\n  let cacheIndex=cacheStack.indexOf(index);\r\n  if (cacheIndex>=0) {\r\n    cacheStack.splice(cacheIndex,1);\r\n  }\r\n  cacheStack.push(index);\r\n  if (cacheStack.length>settings.cacheSize) {\r\n    let deleted=cacheStack.splice(0,cacheStack.length-settings.cacheSize);\r\n    deleted.map((v)=>{\r\n      let slide=state.sequence[v];\r\n      Object.values(slide.layers).map( (layer) => {\r\n        layer.loaded=false;\r\n        layer.included=false;\r\n        layer.visible=false;\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport const resetIncludedLayers = (state,index) => {\r\n  let included={};\r\n  let target=state.sequence[index];\r\n  if (target) {\r\n    included[target.id]=true;\r\n  }\r\n  state.sequence.map((v)=>{\r\n    let isIncluded=included[v.id];\r\n    for (let layerName in v.layers) {\r\n      let layer=v.layers[layerName];\r\n      if (isIncluded) {\r\n        layer.included=true;\r\n        if (layer.ignore) layer.loaded=true;\r\n      }\r\n    }\r\n  });\r\n\r\n  state.blockInteraction=true;\r\n\r\n  if (checkSlideLoaded(target.layers)) {\r\n    updateCacheStack(index,state);\r\n    state.readyToInit=true;\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nexport const reduceViewLoaded = (state,slideIndex,layerId) => {\r\n\r\n  let layers=state.sequence[slideIndex].layers;\r\n  layers[layerId].loaded=true;\r\n\r\n  state.readyToInit=checkSlideLoaded(layers);\r\n  if (state.readyToInit) {\r\n    updateCacheStack(slideIndex,state);\r\n  }\r\n\r\n  state.blockRender=true;\r\n\r\n  return state;\r\n\r\n}\r\n\r\nexport const reduceReady = (state) => {\r\n  state.sequence.map((v,i)=>{\r\n    Object.values(v.layers).map( (layer) => {\r\n      if (layer.loaded) {\r\n        layer.included=true;\r\n        layer.visible=true;\r\n        if (layer.static) {\r\n          layer.visible=(i===state.position);\r\n        }\r\n      }\r\n    })\r\n  });\r\n\r\n  state.viewPosition=state.position;\r\n  state.readyToInit=false;\r\n  state.blockRender=false;\r\n\r\n  if (state.position===settings.startPosition) {\r\n    state.blockInteraction=false;\r\n  }\r\n\r\n\r\n  return state;\r\n}\r\n","import {resetIncludedLayers} from './assetHelper.js'\r\n\r\nexport const reduceToSlideIndex = (state,index) => {\r\n  state=resetIncludedLayers(state,index);\r\n  return {\r\n    ...state,\r\n    position:index,\r\n  }\r\n}\r\n\r\nexport const reduceToSlideId = (state,id) => {\r\n  let position=state.position;\r\n  let slide=state.sequence.find(v => v.id===id);\r\n  if (slide) {\r\n    state=resetIncludedLayers(state,slide.index);\r\n    position=slide.index;\r\n  }\r\n  return {\r\n    ...state,\r\n    position,\r\n  }\r\n}\r\n","import {reduceToSlideIndex, reduceToSlideId} from './helpers/navHelper.js'\n\nconst navReducer = (state={}, action) => {\n\n  console.log(\"navReducer\",action);\n\n  switch (action.type) {\n\n    case 'START_PLAYBACK':\n    {\n      state={\n        ...reduceToSlideIndex(state,0),\n        playbackStarted:true,\n      }\n      break;\n    }\n\n\n    case 'NEXT_SLIDE': {\n      let index=state.position;\n      if (index<state.sequence.length-1) {\n        state={\n          ...reduceToSlideIndex(state,index+1),\n        }\n      }\n      break;\n    }\n\n    case 'PREV_SLIDE': {\n      let index=state.position;\n      if (index>0) {\n        state={\n          ...reduceToSlideIndex(state,index-1),\n        }\n      }\n      break;\n    }\n\n    case 'GOTO_SLIDE_INDEX': {\n      state={\n        ...reduceToSlideIndex(state,action.index),\n      }\n      break;\n    }\n\n    case 'GOTO_SLIDE': {\n      state={\n        ...reduceToSlideId(state,action.id),\n      }\n      break;\n    }\n\n    case 'APPLY_VIEW_POSITION': {\n      state={\n        ...state,\n        viewPosition:state.position,\n      }\n      break;\n    }\n\n    case 'BLOCK_INTERACTION': {\n      state={\n        ...state,\n        blockInteraction:true,\n      }\n      break;\n    }\n\n    case 'UNBLOCK_INTERACTION': {\n      state={\n        ...state,\n        blockInteraction:false,\n      }\n      break;\n    }\n\n    case 'HIDE_LAYER': {\n      let slide=state.sequence[action.index];\n      if (slide) {\n        let layer=slide.layers[action.name];\n        if (layer) {\n          layer.hiddenNow=true;\n          state={\n            ...state,\n          }\n        }\n      }\n      break;\n    }\n\n    case 'SHOW_LAYER': {\n      let slide=state.sequence[action.index];\n      if (slide) {\n        let layer=slide.layers[action.name];\n        if (layer) {\n          layer.hiddenNow=false;\n          state={\n            ...state,\n          }\n        }\n      }\n      break;\n    }\n\n    case 'SWITCH_LAYER': {\n      let slide=state.sequence[action.index];\n      if (slide) {\n        let layer=slide.layers[action.name];\n        if (layer) {\n          if (layer.hiddenNow)\n            layer.hiddenNow=false;\n          else\n            layer.hiddenNow=true;\n          state={\n            ...state,\n          }\n        }\n      }\n      break;\n    }\n\n    default:{}\n  }\n  return state\n}\n\n\nexport default navReducer\n","import {reduceViewLoaded, reduceReady} from './helpers/assetHelper.js'\n\nconst assetReducer = (state={}, action) => {\n\n  console.log(\"assetReducer\",action);\n\n  switch (action.type) {\n\n    case 'VIEW_LOADED': {\n      state={\n        ...reduceViewLoaded(state,action.slideIndex,action.layerName),\n      }\n      break;\n    }\n\n    case 'INIT_IS_DONE':\n    {\n      state={\n        ...reduceReady(state),\n      }\n      break;\n    }\n\n    default:{}\n  }\n  return state\n}\n\n\nexport default assetReducer\n","import settings from '../configuration/settings.js'\r\nimport navReducer from './navReducer.js'\r\nimport assetReducer from './assetReducer.js'\r\n\r\n\r\nlet mainReducerController = (state={}, action) => {\r\n\r\n  console.log(\"mainReducer\",action);\r\n\r\n  switch (action.type) {\r\n\r\n    case 'APP_INIT': {\r\n      state = {\r\n        ...state,\r\n        ...settings.defaultState,\r\n      }\r\n      break;\r\n    }\r\n\r\n    case 'SET_STORE_DATA':\r\n    case 'LOAD_STORE_DATA_ERROR':\r\n    {\r\n      state={\r\n        ...state,\r\n        ...action.data,\r\n      }\r\n      break;\r\n    }\r\n\r\n    default: {}\r\n  }\r\n  return state;\r\n}\r\n\r\n\r\nconst mainReducer = (state={}, action) => {\r\n\r\n  if (action.extraAction) {\r\n    state = mainReducer(state,action.extraAction);\r\n  }\r\n\r\n  state = mainReducerController(state,action);\r\n  state = navReducer(state,action);\r\n  state = assetReducer(state,action);\r\n\r\n\r\n  return state;\r\n}\r\n\r\n\r\nexport default mainReducer\r\n","import React, { Component } from 'react';\r\nimport path from 'path';\r\nimport settings from '../configuration/settings.js'\r\n\r\nimport '../css/view.css';\r\n\r\nclass View extends Component {\r\n\r\n  render() {\r\n\r\n    let layer=this.props.layer;\r\n\r\n    if (!layer.source.path) {\r\n      return null;\r\n    }\r\n\r\n    let source=\"./\"+path.join(layer.source.path,settings.indexHtmlFile);\r\n\r\n    let left=(-(this.props.bounds.native.maxWidth-this.props.bounds.size.width)/2);\r\n    let top=(-(this.props.bounds.native.maxHeight-this.props.bounds.size.height)/2);\r\n\r\n    let containerLeft;\r\n    let containerTop;\r\n    let containerRight;\r\n    let containerBottom;\r\n\r\n    if (layer.align?.indexOf(\"top\")>=0) {\r\n      if (Math.round(this.props.bounds.native.maxHeight*this.props.bounds.scale)>this.props.bounds.size.height) {\r\n        top=(this.props.bounds.native.maxHeight*this.props.bounds.scale-this.props.bounds.native.maxHeight)/2;\r\n      }\r\n      containerTop=0;\r\n    } else\r\n    if (layer.align?.indexOf(\"bottom\")>=0) {\r\n      if (Math.round(this.props.bounds.native.maxHeight*this.props.bounds.scale)>this.props.bounds.size.height) {\r\n        top=((this.props.bounds.native.maxHeight*this.props.bounds.scale-this.props.bounds.native.maxHeight)/2)-(this.props.bounds.native.maxHeight*this.props.bounds.scale-this.props.bounds.size.height);\r\n      }\r\n      containerBottom=0;\r\n    }\r\n    top=Math.round(top);\r\n\r\n    if (layer.align?.indexOf(\"left\")>=0) {\r\n      if (Math.round(this.props.bounds.native.maxWidth*this.props.bounds.scale)>this.props.bounds.size.width) {\r\n        left=(this.props.bounds.native.maxWidth*this.props.bounds.scale-this.props.bounds.native.maxWidth)/2;\r\n      }\r\n      containerLeft=0;\r\n    } else\r\n    if (layer.align?.indexOf(\"right\")>=0) {\r\n      if (Math.round(this.props.bounds.native.maxWidth*this.props.bounds.scale)>this.props.bounds.size.width) {\r\n        left=((this.props.bounds.native.maxWidth*this.props.bounds.scale-this.props.bounds.native.maxWidth)/2)-(this.props.bounds.native.maxWidth*this.props.bounds.scale-this.props.bounds.size.width);\r\n      }\r\n      containerRight=0;\r\n    }\r\n    left=Math.round(left);\r\n\r\n\r\n    let containerWidth=this.props.bounds.native.maxWidth;\r\n    let containerHeight=this.props.bounds.native.maxHeight;\r\n\r\n    if (layer.width) {\r\n      if ((containerLeft==null)&&(containerRight==null)) {\r\n        containerLeft=(containerWidth-layer.width)/2;\r\n      }\r\n      containerWidth=layer.width;\r\n    }\r\n    if (layer.height) {\r\n      if ((containerTop==null)&&(containerBottom==null)) {\r\n        containerTop=(containerHeight-layer.height)/2;\r\n      }\r\n      containerHeight=layer.height;\r\n    }\r\n    if (layer.margin) {\r\n      if (layer.margin.l) {\r\n        if (!containerLeft) containerLeft=layer.margin.l; else containerLeft+=layer.margin.l;\r\n      } else\r\n      if (layer.margin.r) {\r\n        if (!containerRight) containerRight=layer.margin.r; else containerRight+=layer.margin.r;\r\n      }\r\n      if (layer.margin.t) {\r\n        if (!containerTop) containerTop=layer.margin.t; else containerTop+=layer.margin.t;\r\n      } else\r\n      if (layer.margin.b) {\r\n        if (!containerBottom) containerBottom=layer.margin.b; else containerBottom+=layer.margin.b;\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className=\"view\"\r\n        style={{\r\n          ...this.props.bounds.style,\r\n          ...this.props.style,\r\n          visibility:((this.props.hidden)||(this.props.invisible))?\"hidden\":\"visible\",\r\n        }}\r\n      >\r\n        <div\r\n          className=\"viewScaler\"\r\n          style={{\r\n            width:this.props.bounds.native.maxWidth,\r\n            height:this.props.bounds.native.maxHeight,\r\n            left,\r\n            top,\r\n            transform:`scale(${this.props.bounds.scale})`,\r\n          }}\r\n        >\r\n          <iframe\r\n            title={this.props.name}\r\n            name={this.props.name}\r\n            src={source}\r\n            className='viewContainer'\r\n            style={{\r\n              width:containerWidth,\r\n              height:containerHeight,\r\n              left:containerLeft,\r\n              top:containerTop,\r\n              right:containerRight,\r\n              bottom:containerBottom,\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default View;\r\n","import React, { Component } from 'react';\r\nimport settings from '../configuration/settings.js'\r\n\r\nimport View from './View.js';\r\n\r\nimport '../css/layer.css';\r\n\r\nclass ScrollableLayer extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      transition:false,\r\n      from:0,\r\n      to:0,\r\n      fromOffset:0,\r\n      toOffset:0,\r\n      scrollOffset:0,\r\n    };\r\n    this.scrollOffset=0;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.position!==this.props.position) {\r\n      let from=prevProps.position;\r\n      let to=this.props.position;\r\n\r\n      let fromOffset=0;\r\n      let toOffset=0;\r\n\r\n      if (from>to) {\r\n        fromOffset=this.scrollOffset;\r\n        toOffset=this.scrollOffset-1;\r\n        this.scrollOffset--;\r\n      } else\r\n      if (from<to) {\r\n        fromOffset=this.scrollOffset;\r\n        toOffset=this.scrollOffset+1;\r\n        this.scrollOffset++;\r\n      }\r\n      this.setState({\r\n        ...this.state,\r\n        transition:true,\r\n        from,\r\n        to,\r\n        fromOffset,\r\n        toOffset,\r\n        scrollOffset:this.scrollOffset,\r\n      })\r\n    }\r\n  }\r\n\r\n  transitionReady() {\r\n    this.setState({...this.state,transition:false});\r\n    if (this.props.layer.master) this.props.onTransitionReady();\r\n  }\r\n\r\n  render() {\r\n    let sequence=this.props.sequence;\r\n    let slide=this.props.slide;\r\n    let isHidden=false;\r\n    let isntStatic=!this.props.layer.static;\r\n\r\n    // let distance=this.state.from-this.state.to;\r\n    let scrollPosition=0;\r\n    let fromPosition=0;\r\n    let toPosition=0;\r\n\r\n    if (isntStatic) {\r\n      fromPosition=this.state.fromOffset*this.props.bounds.size.width;\r\n      toPosition=this.state.toOffset*this.props.bounds.size.width;\r\n      scrollPosition=-this.state.scrollOffset*this.props.bounds.size.width;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className=\"layer\"\r\n        style={{\r\n          ...this.props.bounds.style,\r\n          ...this.props.style,\r\n          left:scrollPosition,\r\n          transition: (isntStatic&&this.state.transition)?`left ${settings.transition.duration}s ${settings.transition.easing} ${settings.transition.delay}s`:null,\r\n        }}\r\n        onTransitionEnd={()=>{this.transitionReady();}}\r\n      >\r\n      {\r\n        sequence.map((v,i) => {\r\n          let layer=v.layers[this.props.layer.name];\r\n          let xPosition=0;\r\n          let hide=false;\r\n          if (isntStatic) {\r\n            if (i===this.state.from) {\r\n              xPosition=fromPosition;\r\n            } else\r\n            if (i===this.state.to) {\r\n              xPosition=toPosition;\r\n            } else\r\n            if (this.state.from===-1) {\r\n              xPosition=0;\r\n            } else {\r\n              hide=true;\r\n            }\r\n          }\r\n          if ((layer.included)&&(!layer.ignore)) {\r\n            return (\r\n              <View\r\n                name={v.id+\"|\"+layer.name+\"|\"+i}\r\n                key={\"Slide\"+i}\r\n                layer={layer}\r\n                bounds={this.props.bounds}\r\n                hidden={layer.hiddenNow}\r\n                invisible={((!layer.visible)||hide)}\r\n                style={{\r\n                  left:xPosition,\r\n                }}\r\n              />\r\n            )\r\n          } else {\r\n            return null;\r\n          }\r\n        })\r\n      }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ScrollableLayer;\r\n","import React, { Component } from 'react';\r\n\r\nimport ScrollableLayer from './ScrollableLayer.js';\r\n\r\n\r\nimport '../css/projector.css';\r\n\r\nclass Layer extends Component {\r\n\r\n  render() {\r\n\r\n    let state=this.props.state;\r\n    let currentSlide=state.sequence[state.position];\r\n\r\n    return (\r\n      <div\r\n        id=\"Projector\"\r\n        className=\"projector\"\r\n        style={this.props.bounds.style}\r\n      >\r\n        {\r\n          state.layers.map((v,i) => {\r\n            let layer=currentSlide.layers[v.name];\r\n            return (\r\n              <ScrollableLayer\r\n                key={v.name}\r\n                layer={layer}\r\n                slide={currentSlide}\r\n                sequence={state.sequence}\r\n                bounds={this.props.bounds}\r\n                position={state.viewPosition}\r\n                onTransitionReady={this.props.onTransitionReady}\r\n              />\r\n            )\r\n          })\r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Layer;\r\n","import React, { Component } from 'react';\r\n\r\nimport Projector from '../components/Projector.js';\r\nimport { unblockInteraction } from '../actions/navActions.js';\r\n\r\n\r\nimport '../css/container.css';\r\n\r\nclass Container extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.store = this.props.store;\r\n    this.state={};\r\n    this.transitionReadyHandler=this.transitionReadyHandler.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      if (state.blockRender) return;\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  transitionReadyHandler() {\r\n    this.store.dispatch(unblockInteraction());\r\n  }\r\n\r\n  getViewPort(windowWidth,windowHeight,conf) {\r\n\r\n    let boxScale=Math.min(windowWidth/conf.minWidth,windowHeight/conf.minHeight);\r\n\r\n    let boxWidth=conf.minWidth*boxScale;\r\n    let boxHeight=conf.minHeight*boxScale;\r\n\r\n    let maxWidth=conf.maxWidth*boxScale;\r\n    let maxHeight=conf.maxHeight*boxScale;\r\n\r\n    if (windowHeight<maxHeight) boxHeight=windowHeight; else boxHeight=maxHeight;\r\n    if (windowWidth<maxWidth) boxWidth=windowWidth; else boxWidth=maxWidth;\r\n\r\n    let boxLeft=(windowWidth-boxWidth)*.5+conf.offsetX;\r\n    let boxTop=(windowHeight-boxHeight)*.5+conf.offsetY;\r\n\r\n    let boxFontSize = boxScale*conf.nominalFontSize;\r\n\r\n    boxWidth=Math.round(boxWidth);\r\n    boxHeight=Math.round(boxHeight);\r\n    boxLeft=Math.round(boxLeft);\r\n    boxTop=Math.round(boxTop);\r\n    boxFontSize=Math.round(boxFontSize);\r\n    return {boxWidth,boxHeight,boxLeft,boxTop,boxScale,boxFontSize};\r\n  }\r\n\r\n\r\n  updateGlobalFontSize(fontSize) {\r\n    document.getElementsByTagName('html')[0].style['font-size']=fontSize+'px';\r\n  }\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    if (this.state.position>=0) {\r\n\r\n      let {boxWidth,boxHeight,boxLeft,boxTop,boxScale,boxFontSize}=this.getViewPort(this.props.windowWidth,this.props.windowHeight,this.state.settings);\r\n      if (boxScale) {\r\n\r\n        let bounds={\r\n          size:{\r\n            width:boxWidth,\r\n            height:boxHeight,\r\n            top:boxTop,\r\n            left:boxLeft,\r\n          },\r\n          style:{\r\n            width:boxWidth+\"px\",\r\n            height:boxHeight+\"px\",\r\n          },\r\n          native:{\r\n            minWidth:this.state.settings.minWidth,\r\n            minHeight:this.state.settings.minHeight,\r\n            maxWidth:this.state.settings.maxWidth,\r\n            maxHeight:this.state.settings.maxHeight,\r\n          },\r\n          scale:boxScale,\r\n        };\r\n\r\n        this.updateGlobalFontSize(boxFontSize);\r\n\r\n        children.push(\r\n          <div\r\n            id=\"Container\"\r\n            key=\"Container\"\r\n            className=\"globalContainer\"\r\n            style={{\r\n              background:this.state.settings.globalBg,\r\n            }}\r\n          >\r\n            <div\r\n              className=\"contentContainer\"\r\n              style={{\r\n                ...bounds.style,\r\n                left:boxLeft+\"px\",\r\n                top:boxTop+\"px\",\r\n                background:this.state.settings.containerBg,\r\n              }}\r\n            >\r\n              <Projector\r\n                state={this.state}\r\n                bounds={bounds}\r\n                onTransitionReady={this.transitionReadyHandler}\r\n              />\r\n            </div>\r\n          </div>\r\n        )\r\n      }\r\n    }\r\n\r\n    return children;\r\n  }\r\n}\r\n\r\nexport default Container;\r\n","export const startPlayback = () => {\r\n  return {\r\n    type: 'START_PLAYBACK',\r\n  }\r\n}\r\n\r\nexport const nextSlide = () => {\r\n  return {\r\n    type: 'NEXT_SLIDE',\r\n  }\r\n}\r\n\r\nexport const prevSlide = () => {\r\n  return {\r\n    type: 'PREV_SLIDE',\r\n  }\r\n}\r\n\r\nexport const gotoSlideIndex = (index) => {\r\n  return {\r\n    type: 'GOTO_SLIDE_INDEX',\r\n    index,\r\n  }\r\n}\r\n\r\nexport const gotoSlide = (id) => {\r\n  return {\r\n    type: 'GOTO_SLIDE',\r\n    id,\r\n  }\r\n}\r\n\r\nexport const applyViewPosition = () => {\r\n  return {\r\n    type: 'APPLY_VIEW_POSITION',\r\n  }\r\n}\r\n\r\nexport const blockInteraction = () => {\r\n  return {\r\n    type: 'BLOCK_INTERACTION',\r\n  }\r\n}\r\n\r\nexport const unblockInteraction = () => {\r\n  return {\r\n    type: 'UNBLOCK_INTERACTION',\r\n  }\r\n}\r\n\r\nexport const hideLayer = (index,name) => {\r\n  return {\r\n    type: 'HIDE_LAYER',\r\n    index,\r\n    name,\r\n  }\r\n}\r\n\r\nexport const showLayer = (index,name) => {\r\n  return {\r\n    type: 'SHOW_LAYER',\r\n    index,\r\n    name,\r\n  }\r\n}\r\n\r\nexport const switchLayer = (index,name) => {\r\n  return {\r\n    type: 'SWITCH_LAYER',\r\n    index,\r\n    name,\r\n  }\r\n}\r\n","export const isObject = (object) => {\r\n  return object.constructor === Object;\r\n}\r\n\r\nexport const objectIsEmpty = (object) => {\r\n  return Object.keys(object).length === 0 && object.constructor === Object;\r\n}\r\n\r\nexport const cloneObject = (object) => {\r\n   return JSON.parse(JSON.stringify(object));\r\n}\r\n\r\nexport const concatObjects = (object1,object2) => {\r\n  let result={};\r\n  let keys=[...Object.keys(object1),...Object.keys(object2)];\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((object1[keys[i]]!==undefined)&&(object1[keys[i]]!==null)&&(object1[keys[i]]!=='')) {\r\n      result[keys[i]]=object1[keys[i]];\r\n    } else\r\n    if ((object2[keys[i]]!==undefined)&&(object2[keys[i]]!==null)&&(object2[keys[i]]!=='')) {\r\n      result[keys[i]]=object2[keys[i]];\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nexport const concatToObject = (object,data) => {\r\n  let keys=[...Object.keys(object),...Object.keys(data)];\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((object[keys[i]]!==undefined)&&(object[keys[i]]!==null)&&(object[keys[i]]!=='')) {\r\n    } else\r\n    if ((data[keys[i]]!==undefined)&&(data[keys[i]]!==null)&&(data[keys[i]]!=='')) {\r\n      object[keys[i]]=data[keys[i]];\r\n    }\r\n  }\r\n}\r\n\r\nexport const copyObjects = (object,data) => {\r\n  let keys=Object.keys(data);\r\n  let result={\r\n    ...object,\r\n  };\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((data[keys[i]]!==undefined)&&(data[keys[i]]!==null)&&(data[keys[i]]!=='')) {\r\n      result[keys[i]]=data[keys[i]];\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nexport const copyToObject = (object,data) => {\r\n  let keys=Object.keys(data);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((data[keys[i]]!==undefined)&&(data[keys[i]]!==null)&&(data[keys[i]]!=='')) {\r\n      object[keys[i]]=data[keys[i]];\r\n    }\r\n  }\r\n}\r\n\r\nexport const deepCopyToObject = (object,data) => {\r\n  let keys=Object.keys(data);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((data[keys[i]]!==undefined)&&(data[keys[i]]!==null)&&(data[keys[i]]!=='')) {\r\n      if (\r\n          ((object[keys[i]])&&(object[keys[i]].constructor === Object))&&\r\n          ((data[keys[i]])&&(data[keys[i]].constructor === Object))\r\n      )\r\n      {\r\n        deepCopyToObject(object[keys[i]],data[keys[i]]);\r\n      } else {\r\n        object[keys[i]]=data[keys[i]];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const copyToObjectForKeys = (keyList,object,data) => {\r\n  for (let i = 0; i < keyList.length; i++) {\r\n    if ((data[keyList[i]]!==undefined)&&(data[keyList[i]]!==null)&&(data[keyList[i]]!=='')) {\r\n      object[keyList[i]]=data[keyList[i]];\r\n    }\r\n  }\r\n}\r\n\r\nexport const copyToObjectByKeyObject = (keyObject,object,data) => {\r\n  let keys=Object.keys(keyObject);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if ((data[keys[i]]!==undefined)&&(data[keys[i]]!==null)&&(data[keys[i]]!=='')) {\r\n      object[keys[i]]=data[keys[i]];\r\n    }\r\n  }\r\n}\r\n\r\nexport const objectToArrayByIndex = (object) => {\r\n  let result=[];\r\n  for (let id in object) {\r\n    result.push(object[id]);\r\n  }\r\n  result.sort((a,b)=>{\r\n    return (a.index>b.index)?1:(a.index===b.index)?0:-1;\r\n  });\r\n  return result;\r\n}\r\n\r\nexport const objectToObjectByIndex = (object) => {\r\n  let result={};\r\n  for (let id in object) {\r\n    result[object[id].index]=object[id];\r\n  }\r\n  return result;\r\n}\r\n","export const applyMacrosObject = (object,data) => {\r\n  if (data) {\r\n    for (let name in object) {\r\n      let regExp = new RegExp(\"\\\\{\"+name+\"\\\\}\",\"g\");\r\n      data=data.replace(regExp,object[name]);\r\n    }\r\n  } else {\r\n    data=null;\r\n  }\r\n  return data;\r\n}\r\n","// import settings from '../configuration/settings.js'\r\nimport { concatObjects } from '../helpers/objectTools.js'\r\nimport { applyMacrosObject } from '../helpers/macrosTools.js'\r\nimport { getMatches } from '../helpers/stringTools.js'\r\n\r\n\r\nimport dirtyJson from 'dirty-json'\r\n\r\n\r\nclass DataParser {\r\n\r\n  parseSettings(sheet) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    return sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        a[v.A]=v.B;\r\n      }\r\n      return a;\r\n    },{});\r\n  }\r\n\r\n  parseSource(source) {\r\n    let result={};\r\n    if (source) {\r\n      let parseLayer=source.split(\"#\");\r\n      if (parseLayer.length>1) {\r\n        result.frame=parseLayer[1];\r\n      } else {\r\n        result.frame=null;\r\n      }\r\n      parseLayer=parseLayer[0].split(\">\");\r\n      if (parseLayer.length>1) {\r\n        result.path=parseLayer[0];\r\n        result.clip=parseLayer[1];\r\n      } else {\r\n        result.path=parseLayer[0];\r\n        result.clip=null;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  parseLayers(sheet) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    let index = sheet[0];\r\n    let layers = sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        let layer={};\r\n        for (let name in index) {\r\n          layer[index[name]]=v[name];\r\n        }\r\n        layer.source=this.parseSource(layer.source);\r\n        if (!layer.level) layer.level=0;\r\n        if (layer.disable) return a;\r\n        if (layer.margin) {\r\n          let marginParse=getMatches(/(\\D)(\\d+)/gi,layer.margin,2);\r\n          layer.margin=marginParse.reduce((ma,mv,mi)=>{\r\n            ma[mv[0]]=Number(mv[1]);\r\n            return ma;\r\n          },{});\r\n        }\r\n        a.push(layer);\r\n      }\r\n      return a;\r\n    },[]);\r\n\r\n    layers.sort((a,b)=>{\r\n      if (a.level>b.level) return 1;\r\n      if (a.level<b.level) return -1;\r\n      return 0;\r\n    })\r\n\r\n    let layerIndex = layers.reduce((a,v,i)=>{\r\n      a[v.name]=i;\r\n      return a;\r\n    },{});\r\n\r\n    let masterLayer=layers.find((v)=>{return v.master});\r\n    if (!masterLayer) {\r\n      masterLayer=layers.find((v)=>{return !v.static});\r\n      masterLayer.master=1;\r\n    }\r\n\r\n    return { layers, layerIndex};\r\n  }\r\n\r\n  parseTemplates(sheet,layerIndex) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    let index=sheet[0];\r\n    return sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        let template={ layers:{} };\r\n        for (let name in index) {\r\n          if (index[name] in layerIndex) {\r\n            if (!template.layers[index[name]]) template.layers[index[name]]={source:{}};\r\n            template.layers[index[name]].source=this.parseSource(v[name]);\r\n          } else {\r\n            template[index[name]]=v[name];\r\n          }\r\n        }\r\n        if (template.disable) return a;\r\n        a[template.template]=template;\r\n      }\r\n      return a;\r\n    },{});\r\n  }\r\n\r\n\r\n  parseSequence(sheet,layerIndex) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    let index = sheet[0];\r\n    let sequence = sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        let slide={ layers:{} };\r\n        for (let name in index) {\r\n          if (index[name] in layerIndex) {\r\n            if (!slide.layers[index[name]]) slide.layers[index[name]]={source:{}};\r\n            slide.layers[index[name]].source=this.parseSource(v[name]);\r\n          } else {\r\n            slide[index[name]]=v[name];\r\n          }\r\n        }\r\n\r\n        if (slide.params) {\r\n          let params;\r\n          try {\r\n            params = dirtyJson.parse(slide.params);\r\n            if (!params) {\r\n              console.log(\"Unableto parse slide params:\",slide);\r\n            }\r\n          } catch (error) {\r\n            console.log(\"Slide params parsing error:\",slide,error);\r\n            params = null;\r\n          }\r\n          if (params) {\r\n            slide.params=params;\r\n          }\r\n        }\r\n        if (slide.data) {\r\n          slide.data=slide.data.split(\",\");\r\n        }\r\n        slide.index=a.length;\r\n        if (slide.disable) return a;\r\n        a.push(slide);\r\n      }\r\n      return a;\r\n    },[]);\r\n\r\n    return sequence;\r\n  }\r\n\r\n  parseMenus(sheet) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    let index = sheet[0];\r\n    let menus = sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        let menu={};\r\n        for (let name in index) {\r\n          menu[index[name]]=v[name];\r\n        }\r\n        if (!a[menu.id]) a[menu.id]=[];\r\n        if (!menu.index) menu.index=0;\r\n        a[menu.id].push(menu);\r\n      }\r\n      return a;\r\n    },{});\r\n\r\n    for (let name in menus) {\r\n      menus[name].sort((a,b)=>{\r\n        if (a.index>b.index) return 1;\r\n        if (a.index<b.index) return -1;\r\n        return 0;\r\n      })\r\n    }\r\n\r\n    return menus;\r\n  }\r\n\r\n  parseExtraData(sheet) {\r\n    if (!sheet) {\r\n      return null;\r\n    }\r\n    let index = sheet[0];\r\n    let extraData = sheet.reduce((a,v,i)=>{\r\n      if ((v)&&(i>0)) {\r\n        let data={};\r\n        for (let name in index) {\r\n          data[index[name]]=v[name];\r\n        }\r\n        if (!a[data.id]) a[data.id]={};\r\n        a[data.id][data.property]=data;\r\n      }\r\n      return a;\r\n    },{});\r\n    return extraData;\r\n  }\r\n\r\n  concatLayers(origin,addition) {\r\n    let result={};\r\n    for (let layerName in origin) {\r\n      let oLayer=origin[layerName];\r\n      if (!addition[layerName]) {\r\n        result[layerName]={\r\n          ...oLayer,\r\n        };\r\n      } else {\r\n        let aLayer=addition[layerName];\r\n        let nLayer=concatObjects(aLayer,oLayer);\r\n\r\n        if (!oLayer.source) oLayer.source={};\r\n        if (!aLayer.source) aLayer.source={};\r\n\r\n        let source={};\r\n        //Если путь не указан никак, то берем новый путь. Иначе - оставляем старый\r\n        if ((aLayer.source.path!=null)&&(aLayer.source.path!==\"\")) {\r\n          source.path=aLayer.source.path;\r\n        } else {\r\n          source.path=oLayer.source.path;\r\n        }\r\n\r\n        //Если клип не указан, то берем новый клип, или заменяем пустой строкой (удаляется старый). Иначе - оставляем старый\r\n        if (aLayer.source.clip!=null) {\r\n          source.clip=aLayer.source.clip;\r\n        } else {\r\n          source.clip=oLayer.source.clip;\r\n        }\r\n\r\n        //Если фрейм не указан, то берем новый фрейм, или заменяем пустой строкой (удаляется старый). Иначе - оставляем старый\r\n        if (aLayer.source.frame!=null) {\r\n          source.frame=aLayer.source.frame;\r\n        } else {\r\n          source.frame=oLayer.source.frame;\r\n        }\r\n\r\n        nLayer.source=source;\r\n\r\n        result[layerName]=nLayer;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  setupLayers(layers,settings) {\r\n    for (let layerName in layers) {\r\n      let layer=layers[layerName];\r\n      if (layer.source.path) {\r\n        layer.source.path = applyMacrosObject(settings,layer.source.path);\r\n      } else {\r\n        layer.ignore=true;\r\n      }\r\n\r\n      layer.hiddenNow=layer.hidden;\r\n    }\r\n    return layers;\r\n  }\r\n\r\n\r\n  collectSequence(slides,settings) {\r\n    let result=[];\r\n\r\n    for (let i = 0; i < slides.sequence.length; i++) {\r\n      let slide=slides.sequence[i];\r\n\r\n      let layers={};\r\n      //Составили набор слоев слайда из списка слоев\r\n      for (let j = 0; j < slides.layers.length; j++) {\r\n        let layer=slides.layers[j];\r\n        layers[layer.name]=layer;\r\n      }\r\n\r\n      //Внесли в слайд коррекции из шаблона слайда, скорректировали слои из шаблона\r\n      let template=slides.templates[slide.template];\r\n      if (template) {\r\n        slide=concatObjects(template,slide);\r\n        layers=this.concatLayers(layers,template.layers);\r\n      }\r\n\r\n      //Скорректи ровали слои слайда из слоев текущего слайда\r\n      layers=this.concatLayers(layers,slides.sequence[i].layers);\r\n\r\n      layers=this.setupLayers(layers,settings);\r\n\r\n\r\n      // let slidelayers=[];\r\n      // //Преобразуем объект со слоями опять в список\r\n      // for (let j = 0; j < slides.layers.length; j++) {\r\n      //   slidelayers.push(layers[slides.layers[j].name]);\r\n      // }\r\n      //\r\n      // slide.layers=slidelayers;\r\n\r\n      slide.layers=layers;\r\n\r\n      result.push(slide);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n\r\n  parse(data) {\r\n\r\n    let slides=this.parseLayers(data.layers);\r\n    slides.templates=this.parseTemplates(data.templates,slides.layerIndex);\r\n    slides.sequence=this.parseSequence(data.sequence,slides.layerIndex);\r\n\r\n    let settings=this.parseSettings(data.settings);\r\n    let menus=this.parseMenus(data.menus);\r\n\r\n    let sequence=this.collectSequence(slides,settings);\r\n\r\n    let layers=slides.layers;\r\n\r\n    let result={\r\n      sequence,\r\n      settings,\r\n      menus,\r\n      layers,\r\n    };\r\n\r\n    let extraData={};\r\n    for (let name in data) {\r\n      if (!(name in result)&&!(name in slides)&&(name.indexOf(\"<\")<0)) {\r\n        extraData[name]=this.parseExtraData(data[name]);\r\n      }\r\n    }\r\n    result.extraData=extraData;\r\n\r\n    return result;\r\n  }\r\n\r\n}\r\n\r\nexport default DataParser;\r\n","export const getMatches = (regexp,data,matchCount) =>\r\n{\r\n  let matchArray;\r\n  let result = [];\r\n  while ((matchArray = regexp.exec(data)) !== null) {\r\n    if (!matchCount) {\r\n      result.push(matchArray[1]);\r\n    } else {\r\n      let matches=[];\r\n      for (let i = 1; i <= matchCount; i++) {\r\n        matches.push(matchArray[i]);\r\n      }\r\n      result.push(matches);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nexport const split = (source) =>\r\n{\r\n  let result=[];\r\n  if (source) {\r\n    result=source.split(/\\s*,\\s*/);\r\n  }\r\n  return result;\r\n}\r\n\r\nexport const replaceObject = (object,data) => {\r\n  if (data) {\r\n    for (let name in object) {\r\n      let regExp = new RegExp(name,\"g\");\r\n      data=data.replace(regExp,object[name]);\r\n    }\r\n  } else {\r\n    data=\"\";\r\n  }\r\n  return data;\r\n}\r\n","import { Component } from 'react';\r\nimport XLSX from 'xlsx';\r\n\r\nimport settings from '../configuration/settings.js';\r\nimport { setStoreData, loadStoreDataError } from '../actions/appActions.js';\r\nimport { callLater } from '../core/helpers.js';\r\n\r\nimport DataParser from './DataParser.js';\r\n\r\n// import content from '../content/presentation.xlsx'\r\n\r\n\r\nclass DataManager extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.store = this.props.store;\r\n    this.state = {\r\n      isLoading:false,\r\n      isLoaded:false,\r\n    }\r\n    this.loader=null;\r\n    this.result=null;\r\n    this.dataParser = new DataParser();\r\n  }\r\n\r\n/* ++++ React methods ++++ */\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.load();\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n  }\r\n\r\n  onStoreChange() {\r\n    // if (this.mounted) {\r\n    //   let state=this.store.getState();\r\n    // }\r\n  }\r\n\r\n  /* ++++ Logic methods ++++ */\r\n\r\n  load() {\r\n\r\n    if (this.state.isLoading) return;\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        isLoading:true,\r\n        isLoaded:false,\r\n      }\r\n    )\r\n\r\n    if ((settings.useEmbeddedContent)&&(settings.content)) {\r\n      console.log(\"Extracting embedded content\");\r\n      callLater(()=>{\r\n        let wb;\r\n        try {\r\n          wb = XLSX.read(settings.content, {type: 'base64'});\r\n        } catch (e) {\r\n          this.onContentLoadError();\r\n          return\r\n        }\r\n        let data = this.convertSheetsToTables(wb.Sheets);\r\n        if (data) {\r\n          data = this.dataParser.parse(data);\r\n          this.onContentLoad(data);\r\n        } else {\r\n          this.onContentLoadError();\r\n        }\r\n      },1000);\r\n\r\n    } else {\r\n\r\n      this.loadXlsx(settings.contentUrl,(data)=>{\r\n        if (data) {\r\n          data = this.dataParser.parse(data);\r\n          this.onContentLoad(data);\r\n        } else {\r\n          this.onContentLoadError({\r\n            lastError:{\r\n              source:settings.contentUrl,\r\n              location:window.location.href,\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n\r\n  onContentLoad(data) {\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        isLoading:false,\r\n        isLoaded:true,\r\n      }\r\n    )\r\n\r\n    this.store.dispatch(\r\n      setStoreData(data)\r\n    );\r\n\r\n  }\r\n\r\n  onContentLoadError(data) {\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        isLoading:false,\r\n        isLoaded:false,\r\n      }\r\n    )\r\n    this.store.dispatch(\r\n      loadStoreDataError(data)\r\n    );\r\n  }\r\n\r\n/* ++++ Load methods ++++ */\r\n\r\n  loadXlsx(url,callback) {\r\n    var oReq = new XMLHttpRequest();\r\n    oReq.open(\"GET\", url, true);\r\n    oReq.responseType = \"arraybuffer\";\r\n    oReq.onload = (e) => {\r\n      let arraybuffer = oReq.response;\r\n      let data = arraybuffer;\r\n      let wb;\r\n      let arr = this.fixXlsx(data);\r\n      let btoaValue=btoa(arr);\r\n      if (settings.outContentToConsole) {\r\n        console.log(\"CONTENT XLSX COPY:\");\r\n        console.log(\"-----------------------------------------------------------\");\r\n        console.log(\"window.content=\\\"\"+btoaValue+\"\\\"\");\r\n        console.log(\"-----------------------------------------------------------\");\r\n      }\r\n      try {\r\n        wb = XLSX.read(btoaValue, {type: 'base64'});\r\n      } catch (e) {\r\n        callback(null);\r\n        return;\r\n      }\r\n      callback(this.convertSheetsToTables(wb.Sheets));\r\n    }\r\n    oReq.send();\r\n  }\r\n\r\n/* ++++ Processing methods ++++ */\r\n\r\n  fixXlsx(data) {\r\n    let o = \"\", l = 0, w = 10240;\r\n    for(; l<data.byteLength/w; ++l) o+=String.fromCharCode.apply(null,new Uint8Array(data.slice(l*w,l*w+w)));\r\n    o+=String.fromCharCode.apply(null, new Uint8Array(data.slice(l*w)));\r\n    return o;\r\n  }\r\n\r\n  convertSheetsToTables(data) {\r\n    let result={};\r\n    for (let id in data) {\r\n      let rows=[];\r\n      result[id]=rows;\r\n      let cells=data[id];\r\n      for (let cellId in cells) {\r\n        let y=cellId.substr(1)-1;\r\n        let x=cellId.substr(0,1);\r\n        if (rows[y]==null) {\r\n          rows[y]=[]\r\n        }\r\n        rows[y][x]=cells[cellId].v;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  render () {\r\n    return null;\r\n  }\r\n\r\n}\r\nexport default DataManager;\r\n","export const appInit = () => {\r\n  return {\r\n    type: 'APP_INIT',\r\n  }\r\n}\r\n\r\nexport const setStoreData = (data) => {\r\n  return {\r\n    type: 'SET_STORE_DATA',\r\n    data:{\r\n      ...data,\r\n      dataLoaded:true,\r\n      loadDataError:false,\r\n    },\r\n  }\r\n}\r\n\r\nexport const loadStoreDataError = (data) => {\r\n  return {\r\n    type: 'LOAD_STORE_DATA_ERROR',\r\n    data:{\r\n      ...data,\r\n      dataLoaded:false,\r\n      loadDataError:true,\r\n    },\r\n  }\r\n}\r\n","import { Component } from 'react';\r\nimport settings from '../configuration/settings.js'\r\nimport { startPlayback, nextSlide, prevSlide, gotoSlide, hideLayer, showLayer, switchLayer } from '../actions/navActions.js';\r\nimport { viewLoaded, initIsDone } from '../actions/assetActions.js';\r\n\r\n\r\nclass Control extends Component {\r\n\r\n  //--------------------------------------------------------------------------\r\n\t//\r\n\t// Constructor\r\n\t//\r\n\t//--------------------------------------------------------------------------\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.store = this.props.store;\r\n  }\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  // React methods\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n    this.initInteractions();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState(state);\r\n\r\n      if ((state.dataLoaded)&&(!state.playbackStarted)) {\r\n        this.store.dispatch(startPlayback());\r\n      } else\r\n      if (state.loadDataError) {\r\n        console.log(\"Presentation data load error...\",state.lastError);\r\n      } else\r\n      if (state.readyToInit) {\r\n        this.sendInit();\r\n        setTimeout(()=>{\r\n          this.store.dispatch(initIsDone());\r\n        },200)\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  // Own methods\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n\r\n  sendInit() {\r\n    this.state.sequence.map((v)=>{\r\n      for (let layerName in v.layers) {\r\n        let layer=v.layers[layerName];\r\n        if (layer.loaded) {\r\n          this.sendMessage(\"init\",{\r\n            source:layer.source,\r\n            params:v.params,\r\n            menus:this.state.menus,\r\n            data:this.state.extraData,\r\n          },v,layer);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n\r\n  initInteractions() {\r\n    window.addEventListener(\"message\", (event) => {\r\n  \t\tlet eventType=event.data.event;\r\n      let eventSource=event.data.source;\r\n      console.log(\"Received Message:\",eventType,eventSource,event);\r\n      if ((eventSource)&&(eventSource!==settings.parentWindowId)) {\r\n        let parseSource=eventSource.split(\"|\");\r\n        let sourceId=parseSource[0];\r\n        let slideLayer=parseSource[1];\r\n        let slideIndex=parseSource[2];\r\n        if ((this.state)&&(this.state.sequence)) {\r\n          let slide=this.state.sequence[slideIndex];\r\n          if (slide) {\r\n            let layer=slide.layers[slideLayer];\r\n            if (layer) {\r\n              this.processInteraction(eventType,event.data,slide,layer);\r\n            }\r\n          }\r\n        }\r\n      }\r\n  \t})\r\n  }\r\n\r\n  sendMessage(eventType,data,slide,layer) {\r\n    console.log(\"Send message:\",eventType,data,slide,layer);\r\n    let targetWindow;\r\n    let targetName;\r\n    if (slide===\"broadcast\") {\r\n      targetName=slide;\r\n      targetWindow=window;\r\n    } else {\r\n      targetName=slide.id+\"|\"+layer.name+\"|\"+slide.index;\r\n      targetWindow = window.frames[targetName];\r\n    }\r\n    if (targetWindow) {\r\n      targetWindow.postMessage(\r\n        {\r\n          event:eventType,\r\n          source:settings.parentWindowId,\r\n          target:targetName,\r\n          data,\r\n        },\r\n        \"*\"\r\n      );\r\n    } else {\r\n      console.log(\"NO TARGET WINDOW\",targetName);\r\n    }\r\n  }\r\n\r\n  processInteraction(eventType,data,slide,layer) {\r\n    console.log(\"Process interaction:\",eventType,data,slide,layer);\r\n\r\n    switch (eventType) {\r\n      case \"complete\": {\r\n        this.store.dispatch(viewLoaded(slide.index,layer.name));\r\n        break;\r\n      }\r\n      case \"next\": {\r\n        if (this.state.blockInteraction) {\r\n          return;\r\n        }\r\n        this.store.dispatch(nextSlide());\r\n        break;\r\n      }\r\n      case \"prev\": {\r\n        if (this.state.blockInteraction) {\r\n          return;\r\n        }\r\n        this.store.dispatch(prevSlide());\r\n        break;\r\n      }\r\n      case \"goto\": {\r\n        if (this.state.blockInteraction) {\r\n          return;\r\n        }\r\n        let slideId;\r\n        if (data.params)\r\n          slideId=data.params[0];\r\n        else\r\n          if (data) slideId=data.id;\r\n        this.store.dispatch(gotoSlide(slideId));\r\n        break;\r\n      }\r\n      case \"hide\": {\r\n        this.store.dispatch(hideLayer(slide.index,data.name));\r\n        break;\r\n      }\r\n      case \"show\": {\r\n        this.store.dispatch(showLayer(slide.index,data.name));\r\n        break;\r\n      }\r\n      case \"switch\": {\r\n        this.store.dispatch(switchLayer(slide.index,data.name));\r\n        break;\r\n      }\r\n      default:{}\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\nexport default Control;\r\n","export const viewLoaded = (slideIndex,layerName) => {\r\n  return {\r\n    type: 'VIEW_LOADED',\r\n    slideIndex,\r\n    layerName,\r\n  }\r\n}\r\n\r\nexport const initIsDone = () => {\r\n  return {\r\n    type: 'INIT_IS_DONE',\r\n  }\r\n}\r\n","import React, { Component } from 'react';\n\nimport settings from './configuration/settings.js'\n\nimport mainReducer from './reducers/mainReducer'\nimport Container from './core/Container';\nimport DataManager from './core/DataManager.js';\nimport Control from './core/Control';\n\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\n\nimport { appInit } from './actions/appActions.js';\n\nimport './css/app.css';\n\nconst Store = createStore(\n  mainReducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n);\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    console.log(settings.startAppText);\n\n    this.state = {\n    };\n\n    this.initHandler=this.initHandler.bind(this);\n    this.resizeHandler=this.resizeHandler.bind(this);\n\n  }\n\n  updateLayout() {\n    let windowInnerWidth=document.documentElement.clientWidth || document.body.clientWidth || window.innerWidth;\n    let windowInnerHeight=document.documentElement.clientHeight || document.body.clientHeight || window.innerHeight;\n\n    this.setState({\n      ...this.state,\n      windowWidth:windowInnerWidth,\n      windowHeight:windowInnerHeight,\n    });\n\n  }\n\n  initHandler(event) {\n    this.updateLayout();\n  }\n\n  resizeHandler(event) {\n    this.updateLayout();\n  }\n\n  componentDidMount() {\n\n    Store.dispatch(\n      appInit()\n    );\n\n    window.addEventListener(\"load\",this.initHandler);\n    window.addEventListener(\"resize\",this.resizeHandler);\n  }\n\n  render() {\n    return (\n      <Provider store={Store}>\n        <Container\n          id=\"Container\"\n          windowWidth={this.state.windowWidth}\n          windowHeight={this.state.windowHeight}\n          store={Store}\n        >\n          <DataManager\n            store={Store}\n          />\n          <Control\n            store={Store}\n          />\n        </Container>\n      </Provider>\n    );\n  }\n\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}